<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Responsive Shopping Cart</title>
  <link rel="stylesheet" href="static/stylecheckout.css">
</head>
<body>

    <span class= "msform" id="msform">

        <!-- progressbar -->
        <ul id="progressbar">
          <li class="active">Select tickets</li>
          <li>Personal Details</li>
          <li>Payment</li>
        </ul>

        <fieldset>
            <h2 class="fs-title">Select tickets</h2>
            <h3 class="fs-subtitle"></h3>
            <div class="shopping-cart"></div>
            <div class="column-labels">
                <label class="product-image">Image</label>
                <label class="product-details">Product</label>
                <label class="product-price">Price</label>
                <label class="product-quantity">Quantity</label>
                <label class="product-removal">Remove</label>
                <label class="product-line-price">Total</label>
            </div>

            <div class="product">
                <div class="product-image">
                    <img src="https://www.shutterstock.com/image-illustration/series-fire-numbers-flame-1-260nw-83061304.jpg">
                </div>
                <div class="product-details">
                    <div class="product-title">Early bird</div>
                </div>
                <div class="product-price" id="product-price">18</div>
                <div class="product-quantity">
                    <input type="number" value="1" min="0" id="quantity">
                </div>
                <div class="product-removal">
                    <button class="remove-product">Remove</button>
                </div>
                <div class="product-line-price" id="product-line-price">18</div>
            </div>

            <input type="button" name="next" class="next action-button" value="Next" />
        </fieldset>

        <fieldset>
            <h2 class="fs-title">Personal Details</h2>
            <h3 class="fs-subtitle"></h3>
            <input type="text" id="Name1" placeholder="Name" required/>
            <input type="text" id="Lastname1" placeholder="Last Name" required/>
            <input type="text" id="Mail1" placeholder="Mail" required/>
            <div class="buttom-container">
                <input type="button" name="previous" class="previous action-button-previous" value="Previous"/>
                <form id="checkout-form" action="http://127.0.0.1:4242/create-checkout-session" method="POST">
                    <input type="hidden" name="quantity" id="checkout-quantity" value="1"/>
                    <input type="hidden" name="Name" id= Name-ch placeholder="Name"value ='1'/>
                    <input type="hidden" name="Lastname" id= LastName-ch placeholder="Last Name" value="1"/>
                    <input type="hidden" name="Mail" id=Mail-ch placeholder="Mail" value="'1"/>
                    <input type="hidden" name="discountcode" id="discountcode-input" value="">
                    <button type="button" id="submit-btn" class="checkout">Payment</button>
                </form>
            </div>
        </fieldset>

    </span>
     <!-- Closing form tag for the multi-step form -->

    <script src='https://code.jquery.com/jquery-3.6.4.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js'></script>
    <script src="static/next.js"></script>
    <script src="static/script.js"></script>


    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Function to check if visible inputs are filled before submitting
            function submitForm(e) {
                e.preventDefault(); // Prevent the default form submission behavior
    
                var nameValue = document.getElementById('Name1').value;
                var lastnameValue = document.getElementById('Lastname1').value;
                var mailValue = document.getElementById('Mail1').value;
    
                // Check if visible inputs are filled
                if (nameValue && lastnameValue && mailValue) {
                    // If filled, update hidden inputs and submit form
                    document.getElementById('Name-ch').value = nameValue;
                    document.getElementById('LastName-ch').value = lastnameValue;
                    document.getElementById('Mail-ch').value = mailValue;
                    document.getElementById('checkout-form').submit();
                } else {
                    // If not filled, display an alert or perform any other desired action
                    alert('Please fill out all required fields.');
                }
            }
    
            // Attach the function to the button's click event
            document.getElementById('submit-btn').addEventListener('click', submitForm);
        });
    </script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const urlParams = new URLSearchParams(window.location.search);
    const discountcode = urlParams.get('discountcode');

    // Check if the discountCode is "10percentoff"
    if (discountcode === "10percentoff") {
      // Assuming #product-price is a div
      const currentPrice = parseFloat($('#product-price').text());
      
      // Calculate the discounted price (10% off) and update the content
      const discountedPrice = (currentPrice * 0.9).toFixed(2);
      $('#product-price').text(discountedPrice);
      $('#product-line-price').text(discountedPrice);
      document.getElementById('discountcode-input').value = discountcode;  
    }

    
  });
  
  </script>
</body>
</html>



<form id="checkout-form" action="http://127.0.0.1:4242/create-checkout-session" method="POST">
    <input type="hidden" name="quantity" id="checkout-quantity" value="1">
    <button type="submit" class="checkout">Checkout</button>
  </form>
</div>
